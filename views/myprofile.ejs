<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Profile</title>
    <link rel="stylesheet" href="/css/style-blog-container.css">
    <link rel="shortcut icon" href="/default/favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
    <style>

    </style>

</head>

<body>
    <div class="container-for-full-blog">
        <div class="img-container">
            <img class="img" src="/user/<%= user.image%>" alt="Image">
        </div>
        <form action="/blog/updateprofile/<%= user.id%>" method="post" enctype="multipart/form-data">
            <div class="mb-3">
                <label for="password" class="form-label label ">Email</label>
                <input type="email" class="form-control input" name="email" value="<%= user.email %>" readonly>
            </div>
            <div class="mb-3"  style="position: relative;">
                <label for="password" class="form-label label ">Username</label>
                <input type="text" class="form-control input" id="username" name="username" value="<%= user.username %>">
                <span id="username-status" style="position: absolute; bottom: 8px; right: 1rem;"></span>
            </div>
            <div class="mb-3">
                <label for="password" class="form-label label ">Fullname</label>
                <input type="text" class="form-control input" name="fullname" value="<%= user.fullname %>">
            
            </div>
            <div class="mb-3">
                <label for="password" class="form-label label ">Profile Pic</label>
                <input type="file" class="form-control input" name="image">
            </div>

            <div class="mb-3">
                <label for="password" class="form-label label ">Password</label>
                <input type="text" class="form-control input" id="newpassword" name="password"
                    placeholder="Enter new password">
            </div>
            <div class="mb-3">
                <label for="password" class="form-label label ">Confirm Password</label>
                <input type="password" class="form-control input" id="confirmpassword" name="confirmpassword"
                    placeholder="Confirm New Password">
            </div>
            <button type="submit" id="submitBtn">Update</button>

        </form>
        <a href="/blog/homepage"><button class="homebutton">Homepage</button></a>
    </div>
    <script>
        const input1 = document.getElementById('newpassword');
        const input2 = document.getElementById('confirmpassword');
        const submitBtn = document.getElementById('submitBtn');

        input2.addEventListener('input', function () {
            if (input2.value !== input1.value) {
                submitBtn.disabled = true;
            } else {
                submitBtn.disabled = false;
            }
        });

        input1.addEventListener('input', function () {
            if (input2.value !== input1.value) {
                submitBtn.disabled = true;
            } else {
                submitBtn.disabled = false;
            }
        });

        document.getElementById('username').addEventListener('input', function (e) {
            this.value = this.value.replace(/\s/g, '');
        });

        document.getElementById('myForm').addEventListener('submit', function (e) {
            const usernameInput = document.getElementById('username').value;
            if (/\s/.test(usernameInput)) {
                alert('Spaces are not allowed in the username.');
                e.preventDefault();
            }
        });
    </script>
    <script src="/js/checkAvalability.js"></script>
</body>

</html>